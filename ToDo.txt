Refactor net/tcplistener.py and move validation for actions into their own separate functions

